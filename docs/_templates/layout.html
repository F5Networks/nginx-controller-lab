{% extends "!layout.html" %}
 
{%- block extrahead %}
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-154605239-1"></script>
<script src="/NGINX-Controller3-Demo/_static/jwt-decode.min.js"></script>
<script>
 function cDuser() {
     let token = ("; "+document.cookie).split("; TOKEN=").pop().split(";").shift();
     if (token) {
        let decoded = jwt_decode(token)
        return decoded.sub || null
     }
     return null
 }
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());
 
 gtag('config', 'UA-154605239-1', {
 //'custom_map': {'dimension1': 'Course', 'dimension2': 'Date', 'dimension3': 'Time', 'dimension4': 'User'}
 'custom_map': {'dimension4' : 'User'}
});
const user = cDuser();
gtag('set', {'user_id': user}); // Set the user ID using signed-in user_id.
 //const urlParams = new URLSearchParams(window.location.search);
 //const course = urlParams.get('course');
 //const date = urlParams.get('date');
 //const time = urlParams.get('time');
 //const user = cDuser();
 //gtag('event', 'Clouddocs', {'Course': course, 'Date': date, 'Time': time, 'User': user});
 gtag('event', 'Clouddocs', {'User' : user});
</script>
{% endblock %}
